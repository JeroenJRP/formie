!function(){"use strict";const e=function(e){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return i||(i=Math.random().toString(36).substr(2,5)),`${e}.${i}`};class i{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.initialized=!1,this.$form=e.$form,this.form=this.$form.form,this.$field=e.$field,this.successClass=this.form.getClasses("success"),this.successMessageClass=this.form.getClasses("successMessage"),this.errorClass=this.form.getClasses("error"),this.errorMessageClass=this.form.getClasses("errorMessage"),this.isVisible=!1;const i=new IntersectionObserver((e=>{0==e[0].intersectionRatio?(this.isVisible=!1,this.initialized&&this.onHide()):(this.isVisible=!0,this.initialized&&this.onShow())}),{root:this.$form});setTimeout((()=>{i.observe(this.$field)}),500)}removeSuccess(){this.$field.classList.remove(this.successClass);const e=this.$field.querySelector(`.${this.successMessageClass}`);e&&e.remove()}addSuccess(e){this.$field.classList.add(this.successClass);const i=this.$field.querySelector("[data-field-type] > div");if(!i)return console.error("Unable to find `[data-field-type] > div` to add success message.");const t=document.createElement("div");t.className=this.successMessageClass,t.textContent=e,i.appendChild(t)}removeError(){this.$field.classList.remove(this.errorClass);const e=this.$field.querySelector(`.${this.errorMessageClass}`);e&&e.remove()}addError(e){this.$field.classList.add(this.errorClass);const i=this.$field.querySelector("[data-field-type] > div");if(!i)return console.error("Unable to find `[data-field-type] > div` to add error message.");const t=document.createElement("div");t.className=this.errorMessageClass,t.textContent=e,i.appendChild(t),this.submitHandler&&this.submitHandler.formSubmitError()}updateInputs(e,i){const t=this.$field.querySelector(`[name*="${e}"]`);t&&(t.value=i)}getBillingData(){if(!this.billingDetails)return{};const e={};if(this.billingDetails.billingName){const i=this.getFieldValue(this.billingDetails.billingName);i&&(e.name=i)}if(this.billingDetails.billingEmail){const i=this.getFieldValue(this.billingDetails.billingEmail);i&&(e.email=i)}if(this.billingDetails.billingAddress){e.address={};const i=this.getFieldValue(`${this.billingDetails.billingAddress}[address1]`),t=this.getFieldValue(`${this.billingDetails.billingAddress}[address2]`),s=this.getFieldValue(`${this.billingDetails.billingAddress}[address3]`),r=this.getFieldValue(`${this.billingDetails.billingAddress}[city]`),l=this.getFieldValue(`${this.billingDetails.billingAddress}[zip]`),a=this.getFieldValue(`${this.billingDetails.billingAddress}[state]`),o=this.getFieldValue(`${this.billingDetails.billingAddress}[country]`);i&&(e.address.line1=i),t&&(e.address.line2=t),s&&(e.address.line3=s),r&&(e.address.city=r),l&&(e.address.postal_code=l),a&&(e.address.state=a),o&&(e.address.country=o)}new CustomEvent("modifyBillingDetails",{bubbles:!0,detail:{provider:this,billing:e}});return{billing_details:e}}getFieldValue(e){let i="";e=this.getFieldName(e);const t=this.getFormField(e);return t&&t.forEach((e=>"checkbox"!==e.type&&"radio"!==e.type||e.checked?i=e.value:void 0)),i}getFormField(e){let i=this.$form.querySelectorAll(`[name="${e}"]`);const t=this.$form.querySelectorAll(`[name="${e}[]"]`);return t.length&&(i=t),i}getFieldName(e){return`fields[${e=e.replace("{","").replace("}","").replace("]","").split("[").join("][")}]`}onShow(){}onHide(){}}window.FormiePaymentProvider=i;window.FormiePayWay=class extends i{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super(e),this.$form=e.$form,this.form=this.$form.form,this.$field=e.$field,this.$input=this.$field.querySelector("[data-fui-payway-button]"),this.$input?(this.publishableKey=e.publishableKey,this.currency=e.currency,this.amountType=e.amountType,this.amountFixed=e.amountFixed,this.amountVariable=e.amountVariable,this.paywayScriptId="FORMIE_PAYWAY_SCRIPT",this.publishableKey?this.initialized=!0:console.error("Missing publishableKey for PayWay.")):console.error("Unable to find PayWay placeholder for [data-fui-payway-button]")}onShow(){this.initField()}onHide(){this.onAfterSubmit(),this.form.removeEventListener(e("onFormiePaymentValidate","payway")),this.form.removeEventListener(e("onAfterFormieSubmit","payway"))}initField(){if(document.getElementById(this.paywayScriptId))(function(e){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e5;const t=Date.now(),s=function(r,l){window[e]?r(window[e]):i&&Date.now()-t>=i?l(new Error("timeout")):setTimeout(s.bind(this,r,l),30)};return new Promise(s)})("payway").then((()=>{this.mountCard()}));else{const e=document.createElement("script");e.id=this.paywayScriptId,e.src="https://api.payway.com.au/rest/v1/payway.js",e.async=!0,e.defer=!0,e.onload=()=>{this.mountCard()},document.body.appendChild(e)}this.form.addEventListener(this.$form,e("onFormiePaymentValidate","payway"),this.onValidate.bind(this)),this.form.addEventListener(this.$form,e("onAfterFormieSubmit","payway"),this.onAfterSubmit.bind(this))}mountCard(){payway.createCreditCardFrame({layout:"wide",publishableApiKey:this.publishableKey,tokenMode:"callback"},((e,i)=>{e?console.error(`Error creating frame: ${e.message}`):this.creditCardFrame=i}))}onValidate(e){"submit"!==this.form.submitAction||e.detail.invalid||(e.preventDefault(),this.submitHandler=e.detail.submitHandler,this.removeError(),this.creditCardFrame?this.creditCardFrame.getToken(((e,i)=>{e?(console.error(`Error getting token: ${e.message}`),this.addError(e.message)):(this.updateInputs("paywayTokenId",i.singleUseTokenId),this.submitHandler.submitForm())})):console.error("Credit Card Frame is invalid."))}onAfterSubmit(e){this.creditCardFrame&&(this.creditCardFrame.destroy(),this.creditCardFrame=null),this.updateInputs("paywayTokenId","")}}}();