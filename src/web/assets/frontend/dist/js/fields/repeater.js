!function(){"use strict";const t=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return e||(e=Math.random().toString(36).substr(2,5)),`${t}.${e}`};window.FormieRepeater=class{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.$form=t.$form,this.form=this.$form.form,this.$field=t.$field,this.disabledClass=this.form.getClasses("disabled"),this.rowCounter=0,this.initRepeater()}initRepeater(){const e=this.getRows();this.$field.repeater=this,this.$addButton=this.$field.querySelector("[data-add-repeater-row]"),this.minRows=parseInt(this.$addButton.getAttribute("data-min-rows")),this.maxRows=parseInt(this.$addButton.getAttribute("data-max-rows")),this.$addButton&&this.form.addEventListener(this.$addButton,t("click"),(t=>{this.addRow(t)})),e&&e.length&&e.forEach((t=>{this.initRow(t)})),this.$field.dispatchEvent(new CustomEvent("init",{bubbles:!0,detail:{repeater:this}}))}initRow(e){let i=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!e)return void console.error(e);const s=e.querySelector("[data-remove-repeater-row]");if(s&&this.form.addEventListener(s,t("click"),(t=>{this.removeRow(t)})),i){const t=Formie.parseFieldConfig(e,this.$form);Object.keys(t).forEach((e=>{t[e].forEach((t=>{Formie.initJsClass(e,t)}))}))}this.rowCounter++,this.$field.dispatchEvent(new CustomEvent("initRow",{bubbles:!0,detail:{repeater:this,$row:e}}))}addRow(t){t.target;const e=this.$addButton.getAttribute("data-add-repeater-row"),i=document.querySelector(`[data-repeater-template="${e}"]`),s=this.getNumRows();if(i){if(s>=this.maxRows)return;const t=`new${this.rowCounter+1}`,e=i.innerHTML.replace(/__ROW__/g,t);let r=document.createElement("div");r.innerHTML=e.trim(),r=r.querySelector("div:first-of-type"),this.$field.querySelector("[data-repeater-rows]").appendChild(r),setTimeout((()=>{this.updateButton();const t=new CustomEvent("append",{bubbles:!0,detail:{repeater:this,row:r,form:this.$form}});this.$field.dispatchEvent(t),this.initRow(t.detail.row,!0)}),50)}}removeRow(t){const e=t.target.closest("[data-repeater-row]");if(e){if(this.getNumRows()<=this.minRows)return;e.parentNode.removeChild(e);const t=new CustomEvent("remove",{bubbles:!0,detail:{repeater:this,row:e,form:this.$form}});this.$field.dispatchEvent(t),this.updateButton()}}getRows(){return this.$field.querySelectorAll("[data-repeater-row]")}getNumRows(){return this.getRows().length}updateButton(){this.getNumRows()>=this.maxRows?(this.$addButton.classList.add=this.disabledClass,this.$addButton.setAttribute("disabled","disabled")):(this.$addButton.classList.remove=this.disabledClass,this.$addButton.removeAttribute("disabled"))}}}();