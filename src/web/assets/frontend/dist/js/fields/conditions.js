!function(){"use strict";const t=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return e||(e=Math.random().toString(36).substr(2,5)),`${t}.${e}`};window.FormieConditions=class{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.$form=t.$form,this.form=this.$form.form,this.conditionsStore=new WeakMap,this.initFieldConditions()}initFieldConditions(){this.$form.querySelectorAll("[data-field-conditions]").forEach((e=>{const i=this.parseJsonConditions(e);if(!i||!i.conditions.length)return;const o=[];i.conditions.forEach((i=>{let n=this.$form.querySelectorAll(`[name="${i.field}"]`);const s=this.$form.querySelectorAll(`[name="${i.field}[]"]`);if(s.length&&(n=s),(!n||!n.length)&&i.field.includes("[new1]")){const t=i.field.replace(/[.*+?^${}()|[\]\\]/g,"\\$&").replace(/new1/g,"\\d+");n=this.querySelectorAllRegex(new RegExp(t),"name")}n&&n.length&&(i.$targets=n,o.push(i),n.forEach((i=>{const o=this.getEventType(i);this.form.addEventListener(i,t(o),(()=>e.dispatchEvent(new CustomEvent("onFormieEvaluateConditions",{bubbles:!0,detail:{conditions:this}}))))})))})),this.conditionsStore.set(e,{showRule:i.showRule,conditionRule:i.conditionRule,isNested:i.isNested||!1,conditions:o}),this.form.addEventListener(e,t("onFormieEvaluateConditions"),this.evaluateConditions.bind(this)),e.dispatchEvent(new CustomEvent("onFormieEvaluateConditions",{bubbles:!0,detail:{conditions:this,init:!0}}))})),this.form.formTheme&&this.form.formTheme.updateFormHash()}evaluateConditions(t){const e=t.target,i=!!t.detail&&t.detail.init,o=this.conditionsStore.get(e);if(!o)return;const{showRule:n,conditionRule:s,conditions:r,isNested:a}=o,l={};r.forEach(((t,e)=>{const{condition:i,value:o,$targets:n,field:s}=t;n.forEach((t=>{let n=!1;const r={},a=t.tagName.toLowerCase(),d=t.getAttribute("type")?t.getAttribute("type").toLowerCase():"",c=`${s}_${e}`;if(l[c]||(l[c]=[]),"date"===d&&(r.isDate=!0),"agree"===t.getAttribute("data-fui-input-type")){if("hidden"===d)return;n=this.testCondition(i,"0"!=o,t.checked),l[c].push(n)}else"checkbox"===d||"radio"===d?(n=this.testCondition(i,o,t.value)&&t.checked,l[c].push(n)):"select"===a&&t.hasAttribute("multiple")?Array.from(t.options).forEach((t=>{n=this.testCondition(i,o,t.value)&&t.selected,l[c].push(n)})):(n=this.testCondition(i,o,t.value,r),l[c].push(n))}))}));const d=[];Object.values(l).forEach((t=>{d.push(t.includes(!0))}));let c=!1;d.length&&(c="all"===s?d.every((t=>!0===t)):d.includes(!0));let u=!1;if(a&&!i){const t=e.closest('[data-field-type="group"], [data-field-type="repeater"]');t&&t.conditionallyHidden&&(u=!0)}u||c&&"show"!==n||!c&&"show"===n?(e.conditionallyHidden=!0,e.setAttribute("data-conditionally-hidden",!0),e.querySelectorAll("input, textarea, select").forEach((t=>{t.setAttribute("disabled",!0)}))):(e.conditionallyHidden=!1,e.removeAttribute("data-conditionally-hidden"),e.querySelectorAll("input, textarea, select").forEach((t=>{t.removeAttribute("disabled")}))),e.dispatchEvent(new CustomEvent("onAfterFormieEvaluateConditions",{bubbles:!0,detail:{conditions:this,init:i}}))}parseJsonConditions(t){const e=t.getAttribute("data-field-conditions");if(e)try{return JSON.parse(e)}catch(t){console.error(`Unable to parse JSON conditions: ${t}`)}return!1}getEventType(t){const e=t.tagName.toLowerCase(),i=t.getAttribute("type")?t.getAttribute("type").toLowerCase():"";return"select"===e||"date"===i?"change":"number"===i?"input":"checkbox"===i||"radio"===i?"click":"keyup"}testCondition(t,e,i){let o=!1;return(arguments.length>3&&void 0!==arguments[3]?arguments[3]:{}).isDate&&(e=new Date(e).valueOf(),i=new Date(i).valueOf()),"="===t?o=e===i:"!="===t?o=e!==i:">"===t?o=parseFloat(i,10)>parseFloat(e,10):"<"===t?o=parseFloat(i,10)<parseFloat(e,10):"contains"===t?o=i.includes(e):"startsWith"===t?o=i.startsWith(e):"endsWith"===t&&(o=i.endsWith(e)),o}querySelectorAllRegex(t,e){const i=[];for(const o of this.$form.querySelectorAll(`[${e}]`))t.test(o.getAttribute(e))&&i.push(o);return i}}}();